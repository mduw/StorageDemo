(this.webpackJsonpstoragememo=this.webpackJsonpstoragememo||[]).push([[0],{31:function(e,t,n){},32:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(18),c=n.n(r);n(31),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(32);var a=n(2),i=n(6),u=n.n(i),s=n(7),l=1048576;function d(e){var t=1024;if(Math.abs(e)<t)return e+" B";var n=["KB","MB","GB","TB","PB","EB","ZB","YB"],o=-1;do{e/=t,++o}while(Math.abs(e)>=t&&o<n.length-1);return e.toFixed(1)+" "+n[o]}function f(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t="abcdefghijklmnopqrstuvwxyz".split(""),n=t.length,o=[];e--;)o.push(t[Math.random()*n|0]);return o.join("")}var b,j,h,p=n(17),O=n(19),g=n.n(O)()((function(e,t){return{quota:{total:0,usage:0},updateQuota:function(t){return e((function(e){return e.quota=Object(p.a)(Object(p.a)({},e.quota),t)}))}}})),x=n(3),v=n(4),m=n(24),E={};E.Btn=v.a.button(b||(b=Object(x.a)(["\n  background-color: ",";\n  color: ",";\n  padding: ",";\n  width: ",";\n  font-size: ",";\n  border-radius: 4px;\n  height: auto;\n  box-shadow: none;\n  border: none;\n  opacity: ",";\n  outline: none;\n  &:hover {\n    cursor: pointer;\n  }\n"])),(function(e){return e.backgroundColor?e.backgroundColor:"#0096ff"}),(function(e){return e.color?e.color:"white"}),(function(e){return e.padding?e.padding:"10px 20px"}),(function(e){return e.width?e.width:"auto"}),(function(e){return e.fontSize?e.fontSize:"1em"}),(function(e){return e.disabled?.5:1})),E.InputField=v.a.input(j||(j=Object(x.a)(["\n  display: block;\n  width: auto;\n  padding: 10px;\n  font-size: ",";\n  &:focus {\n    outline: none;\n    box-shadow: none;\n  }\n"])),(function(e){return e.fontSize?e.fontSize:"1em"})),E.Link=Object(v.a)(m.a)(h||(h=Object(x.a)(["\n  position: absolute;\n  text-decoration: none;\n  padding: 10px;\n  color: block;\n  font-weight: bold;\n  font-size: 1.2em;\n  color:white;\n  background-color: #008fe5;\n"])));var w,D,S,B,I,y,k,C,A,T,R,L=E,N={};N.Wrapper=v.a.div(w||(w=Object(x.a)(["\n  padding: 24px;\n  min-width: 680px;\n  font-size: 18px;\n"]))),N.Btn=Object(v.a)(L.Btn)(D||(D=Object(x.a)(["\n  float: right;\n  width: 100px;\n  margin: 40px 0 35px 30px;\n  text-align: center;\n  outline: none;\n  opacity: 0.9;\n  &:hover {\n    opacity: 1;\n  }\n"]))),N.InfoWrapper=v.a.span(S||(S=Object(x.a)(["\n  position: relative;\n  top: 50%;\n"]))),N.Value=v.a.span(B||(B=Object(x.a)(["\n  font-size: 1.2em;\n  font-weight: bold;\n"]))),N.Section=v.a.section(I||(I=Object(x.a)(["\n  position: relative;\n  display: block;\n  border-top: 1px solid lightgray;\n  margin: 26px auto;\n  clear: both;\n  height: 100px;\n  width: 80%;\n  padding: 0 10px;\n  @media (max-width: 990px) {\n    width: 100%;\n  }\n"]))),N.SectionOuter=Object(v.a)(N.Section)(y||(y=Object(x.a)(["\n  border: none;\n  margin-top: 10vh;\n"]))),N.PlainSectionOuter=Object(v.a)(N.Section)(k||(k=Object(x.a)(["\n  border: none;\n"]))),N.Btn.Clear=Object(v.a)(N.Btn)(C||(C=Object(x.a)(["\n  background: #d44500;\n  width: 100px;\n"]))),N.Btn.ClearAll=Object(v.a)(N.Btn)(A||(A=Object(x.a)(["\n  margin: -30px auto;\n  width: 220px;\n  float: right;\n  background: #d44500;\n"]))),N.InputField=Object(v.a)(L.InputField)(T||(T=Object(x.a)(["\n  float: right;\n  margin: 40px 0 0 20px;\n  text-align: center;\n  padding: 8px;\n  border: none;\n  border-bottom: 1px solid black;\n  width: ",";\n"])),(function(e){return e.width?e.width:"40px"})),N.StaleData=v.a.h3(R||(R=Object(x.a)(["\n  display: block;\n  margin: 10px 0;\n  color: red;\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"])));var F=N,M=n(1);function V(){if("granted"!==Notification.permission)return"Notification"in window?Notification.requestPermission().then((function(e){if("granted"===e)return alert("Notification enabled!"),!0})):alert("This browser does not support desktop notification"),!1}var P=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"===Notification.permission){e.next=5;break}if(V()){e.next=5;break}return alert("Allow notification before persisting storage"),e.abrupt("return");case 5:navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then((function(e){e?console.log("Storage is persisted"):console.log("Storage is NOT persisted")}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,!navigator.storage||!navigator.storage.persist){e.next=6;break}return e.next=4,navigator.storage.persisted();case 4:n=e.sent,t(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var W=function(e){e.refetch,e.setRefetch;var t=Object(o.useState)(!0),n=Object(a.a)(t,2),r=n[0],c=n[1],i=g((function(e){return e.quota})),u=g((function(e){return e.updateQuota}));return Object(o.useEffect)((function(){V();var e=setInterval((function(){z((function(e){return c(e)})),function(e){e&&navigator.storage.estimate().then((function(t){var n=t.quota,o=t.usage;e({total:n,usage:o})})).catch((function(e){return console.log("ERROR ",e)}))}(u)}),1e3);return function(){clearInterval(e)}}),[]),Object(M.jsxs)(F.SectionOuter,{children:[Object(M.jsxs)("p",{children:["isPersisted ="," ",Object(M.jsx)(F.Value,{children:r.toString().toUpperCase()}),Object(M.jsx)(F.Btn,{onClick:P,style:{display:"inline-block",width:"auto",margin:"-8px 0 0 0"},children:"Persist storage"})]}),Object(M.jsx)("div",{children:"Quota = Cache + IndexedDB. DOMStorage (local + session) is not included in Quota"}),Object(M.jsxs)("div",{children:["Used ="," ",Object(M.jsxs)(F.Value,{children:[d(i.usage)," / ",d(i.total),Object(M.jsx)("small",{children:" "})]})]}),Object(M.jsxs)("div",{children:["Available ="," ",Object(M.jsx)(F.Value,{children:d(i.total-i.usage)})]})]})},G=n(26),q=["type","defaultVal","placeholder","postTask"],K=function(e){var t=e.type,n=void 0===t?"string":t,r=e.defaultVal,c=void 0===r?"1":r,i=e.placeholder,u=e.postTask,s=Object(G.a)(e,q),l=Object(o.useState)(c),d=Object(a.a)(l,2),f=d[0],b=d[1];return Object(o.useEffect)((function(){f&&u("number"===n?parseInt(f):f)}),[f]),Object(M.jsx)(F.InputField,{style:s,placeholder:i,value:f,onChange:function(e){return b(e.target.value)}})},U=window,_=U.localStorage,H=U.sessionStorage;function Q(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&(t+=n.length+e.getItem(n).length);return(t/l).toFixed(0)}function J(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r="key".concat(e.length+1,"_").concat(t,"MB");try{e.setItem(r,f(t*l)),n&&n()}catch(error){alert("ERROR: '".concat(error.name,"'")),o&&o()}}function Y(e){e.clear()}var Z=function(e){var t=e.storageType,n=e.name,r=Object(o.useState)(t.length),c=Object(a.a)(r,2),i=c[0],u=c[1],s=Object(o.useState)(2),l=Object(a.a)(s,2),d=l[0],f=l[1],b=Object(o.useState)(!1),j=Object(a.a)(b,2),h=j[0],p=j[1];return Object(o.useEffect)((function(){var e=function(){return u(Q(t))},n=document.getElementById("clearAll-Btn");return n.addEventListener("click",e),function(){n.removeEventListener("click",e)}}),[]),Object(o.useEffect)((function(){var e=setInterval((function(){var e=Q(t);e!==d&&u(e)}),1500);return function(){clearInterval(e)}}),[]),Object(o.useEffect)((function(){var e;return h?e=setInterval((function(){J(t,d,(function(){console.log("".concat(n,": ADDED ").concat(d,"MB")),u(Q(t))}),(function(){p(!h)}))}),1e3):clearInterval(e),function(){clearInterval(e)}}),[h,i,d]),Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(F.Section,{children:[Object(M.jsxs)(F.InfoWrapper,{children:[n," = ",Object(M.jsxs)(F.Value,{children:[i,"MB"]})]}),Object(M.jsx)(F.Btn.Clear,{onClick:function(){Y(t),u(t.length)},children:"Empty"}),Object(M.jsx)(F.Btn,{onClick:function(){return p(!h)},style:{width:"auto"},children:h?"Auto OFF":"Auto ON"}),Object(M.jsx)(F.Btn,{onClick:function(){J(t,d,(function(){console.log("".concat(n,": ADDED ").concat(d,"MB")),u(Q(t))}))},children:"Add"}),Object(M.jsx)(K,{type:"number",defaultVal:"".concat(d),postTask:function(e){return f(e)}})]})})},$=function(){return Object(M.jsx)(Z,{storageType:_,name:"Local Storage"})},X=function(){return Object(M.jsx)(Z,{storageType:H,name:"Session Storage"})},ee=n(25),te="demo_db",ne={users:"users",messages:"messages"},oe=new BroadcastChannel("idb_changes"),re="myid";function ce(e,t){var n=this;return new Promise((function(o,r){var c=0,a=e.transaction([t]).objectStore(t).openCursor();a.onsuccess=function(e){var t=e.target.result;if(t){var n=t.value,r=JSON.stringify(n);c+=r.length,t.continue()}else o(c)}.bind(n),a.onerror=function(e){r("error in "+t+": "+e)}}))}function ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ue((function(t){!function(t,n){var o=t.reduce((function(e,t){return e.push(ce(n,t)),e}),[]);Promise.all(o).then((function(e){console.log("--------- "+n.name+" ---------"),t.forEach((function(t,n){console.log(t+"\t: "+d(e[n]))}));var o=e.reduce((function(e,t){return e+t}),0);return o})).then((function(t){se(n),e&&e(t)}))}(Object(ee.a)(t.objectStoreNames),t)}))}function ie(e){console.log(e)}function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=indexedDB.open(te);t.onerror=function(e){ie("IndexedDB ERR: FAILED TO CONNECT")},t.onsuccess=function(){e&&e(t.result)},t.onupgradeneeded=function(t){var n=t.currentTarget.result;for(var o in ne){n.objectStoreNames.contains(o)&&n.deleteObjectStore(o);var r=n.createObjectStore(o);o===ne.messages&&r.put("1234",re)}ue(e)},t.onblocked=function(){ie("IndexedDB: CONNECTION WAS BLOCKED",error)}}function se(e){e?e.close():ie("IndexedDB: DB NOT FOUND")}function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=ne.messages;!e&&n||(n=f(e*l)),t||(t="".concat((new Date).toLocaleTimeString(),"_msg_").concat(e,"MB"));try{ue((function(c){var a=c.transaction([r],"readwrite"),i=a.objectStore(r).put(n,t);a.onerror=function(e){var t=e.target.error;ie("IndexedDB: transaction error"),"ConstraintError"===t.name&&(alert("Key existed !"),e.preventDefault(),e.stopPropagation())},i.onerror=function(e){ie("IndexedDB ERR: FAILED TO ADD DATA")},i.onsuccess=function(){ie("[".concat((new Date).toLocaleTimeString(),"] IndexedDB: ADDED ").concat(e,"MB")),se(c),o&&o()},i.onblocked=function(){ie("IndexedDB: BLOCKED ADDING ".concat(e,"MB"))}}))}catch(error){ie("IndexedDB ERR:")}}var de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=window.indexedDB.deleteDatabase(te);t.onsuccess=function(){console.log("IndexedDB: ",te,"IS DELETED"),ue((function(e){se(e)})),e&&e()},t.onerror=function(){alert("IndexedDB: FAILED TO DELETE",te)},t.onblocked=function(){alert("IndexedDB: OPERATION BEING BLOCKED")}},fe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{ue((function(o){var r=o.transaction([e],"readonly").objectStore(e).get(t);r.onerror=function(e){ie("IndexedDB ERR: FAILED TO GET")},r.onsuccess=function(){se(o),n&&n(r.result)}}))}catch(error){ie("IndexedDB ERR:")}},be=function(){var e=Object(o.useState)(!0),t=Object(a.a)(e,2),n=t[0],r=t[1],c=Object(o.useState)(1),i=Object(a.a)(c,2),u=i[0],s=i[1],l=Object(o.useState)(0),f=Object(a.a)(l,2),b=f[0],j=f[1],h=Object(o.useState)(),p=Object(a.a)(h,2),O=p[0],x=p[1],v=Object(o.useState)(!1),m=Object(a.a)(v,2),E=m[0],w=m[1],D=Object(o.useState)(""),S=Object(a.a)(D,2),B=S[0],I=S[1],y=Object(o.useState)(""),k=Object(a.a)(y,2),C=k[0],A=k[1],T=Object(o.useState)(1),R=Object(a.a)(T,2),L=R[0],N=R[1],V=Object(o.useState)(!1),P=Object(a.a)(V,2),z=P[0],W=P[1];g((function(e){return e.updateQuota}));oe.onmessage=function(e){var t=e.data,n=t.action,o=t.store,r=t.key;if("UPDATE"===n)G(o,r)};var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne.messages,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re;return fe(e,t,(function(e){I(e)}))};return Object(o.useEffect)((function(){return ue((function(e){G(),ae((function(e){return j(e)})),se(e),r(!1)})),function(){oe.close()}}),[]),Object(o.useEffect)((function(){var e;return E?e=setInterval((function(){le(u,null,null,(function(){return ae((function(e){return j(e)}))}))}),1e3):clearInterval(e),function(){clearInterval(e)}}),[E,b,u]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)(F.Section,{style:{height:"90px"},children:[Object(M.jsxs)(F.InfoWrapper,{children:["IndexedDB = ",Object(M.jsx)(F.Value,{children:d(b)})]}),Object(M.jsx)(F.Btn.Clear,{disabled:n,onClick:function(){return de(ae((function(e){return j(e)})))},children:"Reset"}),Object(M.jsx)(F.Btn,{onClick:function(){w(!E)},style:{width:"auto"},children:E?"Auto OFF":"Auto ON"}),Object(M.jsx)(K,{type:"number",placeholder:"1MB",defaultVal:"10",postTask:function(e){return s(e)}})]}),Object(M.jsxs)(F.PlainSectionOuter,{style:{height:"90px"},children:[Object(M.jsx)(F.InfoWrapper,{children:"Single Item"}),Object(M.jsx)(F.Btn.Clear,{disabled:n,onClick:function(){O?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne.messages,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{ue((function(o){var r=o.transaction([t],"readwrite"),c=r.objectStore(t).delete(e);c.onerror=function(){ie("IndexedDB ERR: FAILED TO DELETE")},c.onsuccess=function(){ie("IndexedDB: DATA ROW DELETED"),se(o),n&&n()},r.oncomplete=function(){console.log("delete completed"),se(o)},r.commit()}))}catch(error){console.log("IndexedDB ERR:",error)}}(O,ne.messages,(function(){return ae((function(e){return j(e)}))})):alert("Key must NOT be empty")},children:"Delete"}),Object(M.jsx)(F.Btn,{disabled:n,onClick:function(){O?le(L,O,C,(function(){ae((function(e){return j(e)})),"myid"===O&&(G(ne.messages,O),z&&oe.postMessage({action:"UPDATE",store:"messages",key:O}))})):alert("Key must NOT be empty")},children:"Add"}),Object(M.jsx)(F.Btn,{disabled:n,onClick:function(){ae()},children:"Size"}),Object(M.jsx)(K,{type:"number",defaultVal:"",placeholder:"size",width:"50px",postTask:function(e){return N(e)}}),Object(M.jsx)(K,{type:"text",placeholder:"Value",defaultVal:"",width:"110px",postTask:function(e){return A(e)}}),Object(M.jsx)(K,{defaultVal:"",placeholder:"Object key",width:"110px",postTask:function(e){return x(e)}})]}),Object(M.jsxs)(F.PlainSectionOuter,{style:{height:"150px"},children:[Object(M.jsx)("h4",{children:"Stale database due to multiple update"}),Object(M.jsx)("input",{type:"checkbox",id:"updateDummy",name:"updateDummy",checked:z,onChange:function(e){return W(!z)}}),Object(M.jsx)("label",{htmlFor:"updateDummy",children:"Trigger update on other tabs"}),Object(M.jsxs)(F.StaleData,{children:[re," | ",B]})]})]})},je="demo-cache",he=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,o,r,c,a=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:null,o="/cache_".concat(Date.now().toString(),"_").concat(t,"MB"),r=new Response(f(t*l)),e.next=5,caches.open(je);case 5:return c=e.sent,e.abrupt("return",c.put(o,r).then((function(){console.log('CACHE STORAGE: SUCCESSFULLY ADDED "'.concat(o,'"')),n&&n()})).catch((function(e){alert("CACHE STORAGE: ERROR! FAILED TO WRITE CACHE")})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function pe(){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open(je);case 2:return t=e.sent,e.next=5,t.keys();case 5:e.sent.forEach((function(e){t.delete(e)})),caches.delete(je).then((function(){console.log("CACHE STORAGE:",je,"IS DELETED")})).then((function(){window.location.reload(!0)})).catch((function(e){return console.error("CACHE STORAGE: FAILED TO DELETE",je,e)}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge=function(){var e=Object(o.useState)(0),t=Object(a.a)(e,2),n=t[0],r=t[1],c=Object(o.useState)(0),i=Object(a.a)(c,2),u=i[0],s=i[1],l=Object(o.useState)(!1),d=Object(a.a)(l,2),f=d[0],b=d[1];return Object(o.useEffect)((function(){var e;return f?e=setInterval((function(){he(u,(function(){return r(n+u)}))}),1e3):clearInterval(e),function(){clearInterval(e)}}),[f,n,u]),Object(M.jsxs)(F.Section,{children:[Object(M.jsxs)(F.InfoWrapper,{children:["Cache Storage = ",Object(M.jsxs)(F.Value,{children:[n,"MB"]})]}),Object(M.jsx)(F.Btn.Clear,{onClick:function(){return pe()},children:"Empty"}),Object(M.jsx)(F.Btn,{onClick:function(){return b(!f)},style:{width:"120px"},children:f?"Auto OFF":"Auto ON"}),Object(M.jsx)(F.Btn,{onClick:function(){return he(u,(function(){return r(n+u)}))},children:"Add"}),Object(M.jsx)(K,{type:"number",defaultVal:"10",postTask:function(e){return s(e)}})]})},xe=function(){var e=Object(o.useState)(!0),t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(M.jsxs)(F.Wrapper,{children:[Object(M.jsx)("h2",{className:"center",children:"Offline Storage Demo"}),Object(M.jsx)(W,{refetch:n,setRefetch:r}),Object(M.jsx)($,{refetch:n}),Object(M.jsx)(X,{refetch:n}),Object(M.jsx)(ge,{}),Object(M.jsx)(be,{}),Object(M.jsx)(F.SectionOuter,{children:Object(M.jsx)(F.Btn.ClearAll,{id:"clearAll-Btn",onClick:function(){Y(window.localStorage),Y(window.sessionStorage),pe(),de(),r(!n)},width:"100%",children:"CLEAR ALL"})})]})},ve=function(){return Object(M.jsx)("div",{className:"App",children:Object(M.jsx)(xe,{})})};c.a.render(Object(M.jsx)(ve,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.83810332.chunk.js.map