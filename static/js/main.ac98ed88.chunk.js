(this.webpackJsonpstoragememo=this.webpackJsonpstoragememo||[]).push([[0],{28:function(e,t,n){},29:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(16),c=n.n(o);n(28),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(29);var a=n(2),i=n(6),s=n.n(i),u=n(7),l=1e6,d=function(e){var t;try{t=new Intl.NumberFormat("en-us",{maximumFractionDigits:1}).format(e/l)}catch(n){t=Math.round(e/l)}return"".concat(t," MB")};function f(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t="abcdefghijklmnopqrstuvwxyz".split(""),n=t.length,r=[];e--;)r.push(t[Math.random()*n|0]);return r.join("")}var j,b,p,O=n(15),h=n(17),g=n.n(h)()((function(e,t){return{quota:{total:0,usage:0},updateQuota:function(t){return e((function(e){return e.quota=Object(O.a)(Object(O.a)({},e.quota),t)}))}}})),x=n(3),v=n(4),m=n(22),E={};E.Btn=v.a.button(j||(j=Object(x.a)(["\n  background-color: ",";\n  color: ",";\n  padding: ",";\n  width: ",";\n  font-size: ",";\n  border-radius: 4px;\n  height: auto;\n  box-shadow: none;\n  border: none;\n  opacity: ",";\n  outline: none;\n  &:hover {\n    cursor: pointer;\n  }\n"])),(function(e){return e.backgroundColor?e.backgroundColor:"#0096ff"}),(function(e){return e.color?e.color:"white"}),(function(e){return e.padding?e.padding:"10px 20px"}),(function(e){return e.width?e.width:"auto"}),(function(e){return e.fontSize?e.fontSize:"1em"}),(function(e){return e.disabled?.5:1})),E.InputField=v.a.input(b||(b=Object(x.a)(["\n  display: block;\n  width: auto;\n  padding: 10px;\n  font-size: ",";\n  &:focus {\n    outline: none;\n    box-shadow: none;\n  }\n"])),(function(e){return e.fontSize?e.fontSize:"1em"})),E.Link=Object(v.a)(m.a)(p||(p=Object(x.a)(["\n  position: absolute;\n  text-decoration: none;\n  padding: 10px;\n  color: block;\n  font-weight: bold;\n  font-size: 1.2em;\n  color:white;\n  background-color: #008fe5;\n"])));var D,S,w,B,I,y,k,A,C,T,R=E,L={};L.Wrapper=v.a.div(D||(D=Object(x.a)(["\n  padding: 24px;\n  min-width: 680px;\n  font-size: 18px;\n"]))),L.Btn=Object(v.a)(R.Btn)(S||(S=Object(x.a)(["\n  float: right;\n  width: 100px;\n  margin: 40px 0 35px 30px;\n  text-align: center;\n  outline: none;\n  opacity: 0.9;\n  &:hover { opacity: 1; }\n"]))),L.InfoWrapper=v.a.span(w||(w=Object(x.a)(["\n  position: relative;\n  top: 50%;\n"]))),L.Value=v.a.span(B||(B=Object(x.a)(["\n  font-size: 1.2em;\n  font-weight: bold;\n"]))),L.Section=v.a.section(I||(I=Object(x.a)(["\n  position: relative;\n  display: block;\n  border-top: 1px solid lightgray;\n  margin: 26px auto;\n  height: 100px;\n  width: 80%;\n  padding: 0 10px;\n  @media (max-width: 990px) {\n    width: 100%;\n  }\n"]))),L.SectionOuter=Object(v.a)(L.Section)(y||(y=Object(x.a)(["\n  border: none;\n  margin-top: 10vh;\n"]))),L.PlainSectionOuter=Object(v.a)(L.Section)(k||(k=Object(x.a)(["\n  border: none;\n"]))),L.Btn.Clear=Object(v.a)(L.Btn)(A||(A=Object(x.a)(["\n  background: #D44500;\n  width: 100px;\n"]))),L.Btn.ClearAll=Object(v.a)(L.Btn)(C||(C=Object(x.a)(["\n  margin: -30px auto;\n  width: 220px;\n  float: right;\n  background: #D44500;\n"]))),L.InputField=Object(v.a)(R.InputField)(T||(T=Object(x.a)(["\n  float: right;\n  margin: 40px 0 0 20px;\n  text-align: center;\n  padding: 8px;\n  border: none;\n  border-bottom: 1px solid black;\n  width: ",";\n"])),(function(e){return e.width?e.width:"40px"}));var F=L,N=n(1);function M(){if("granted"!==Notification.permission)return"Notification"in window?Notification.requestPermission().then((function(e){if("granted"===e)return alert("Notification enabled!"),!0})):alert("This browser does not support desktop notification"),!1}var V=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"===Notification.permission){e.next=5;break}if(M()){e.next=5;break}return alert("Allow notification before persisting storage"),e.abrupt("return");case 5:navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then((function(e){e?console.log("Storage is persisted"):console.log("Storage is NOT persisted")}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!1,!navigator.storage||!navigator.storage.persist){e.next=6;break}return e.next=4,navigator.storage.persisted();case 4:n=e.sent,t(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var P=function(e){e.refetch,e.setRefetch;var t=Object(r.useState)(!0),n=Object(a.a)(t,2),o=n[0],c=n[1],i=g((function(e){return e.quota})),s=g((function(e){return e.updateQuota}));return Object(r.useEffect)((function(){M();var e=setInterval((function(){z((function(e){return c(e)})),function(e){e&&navigator.storage.estimate().then((function(t){var n=t.quota,r=t.usage;e({total:n,usage:r})})).catch((function(e){return console.log("ERROR ",e)}))}(s)}),1e3);return function(){clearInterval(e)}}),[]),Object(N.jsxs)(F.SectionOuter,{children:[Object(N.jsxs)("p",{children:["isPersisted ="," ",Object(N.jsx)(F.Value,{children:o.toString().toUpperCase()}),Object(N.jsx)(F.Btn,{onClick:V,style:{display:"inline-block",width:"auto",margin:"-8px 0 0 0"},children:"Persist storage"})]}),Object(N.jsx)("div",{children:"Quota = Cache + IndexedDB. DOMStorage (local + session) is not included in Quota"}),Object(N.jsxs)("div",{children:["Used ="," ",Object(N.jsxs)(F.Value,{children:[d(i.usage)," / ",d(i.total),Object(N.jsx)("small",{children:" "})]})]}),Object(N.jsxs)("div",{children:["Available ="," ",Object(N.jsx)(F.Value,{children:d(i.total-i.usage)})]})]})},W=n(23),q=["type","defaultVal","placeholder","postTask"],G=function(e){var t=e.type,n=void 0===t?"string":t,o=e.defaultVal,c=void 0===o?"1":o,i=e.placeholder,s=e.postTask,u=Object(W.a)(e,q),l=Object(r.useState)(c),d=Object(a.a)(l,2),f=d[0],j=d[1];return Object(r.useEffect)((function(){f&&s("number"===n?parseInt(f):f)}),[f]),Object(N.jsx)(F.InputField,{style:u,placeholder:i,value:f,onChange:function(e){return j(e.target.value)}})},U=window,_=U.localStorage,K=U.sessionStorage;function H(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&(t+=n.length+e.getItem(n).length);return(t/l).toFixed(0)}function Q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o="key".concat(e.length+1,"_").concat(t,"MB");try{e.setItem(o,f(t*l)),n&&n()}catch(error){alert("ERROR: '".concat(error.name,"'")),r&&r()}}function J(e){e.clear()}var Y=function(e){var t=e.storageType,n=e.name,o=Object(r.useState)(t.length),c=Object(a.a)(o,2),i=c[0],s=c[1],u=Object(r.useState)(2),l=Object(a.a)(u,2),d=l[0],f=l[1],j=Object(r.useState)(!1),b=Object(a.a)(j,2),p=b[0],O=b[1];return Object(r.useEffect)((function(){var e=function(){return s(H(t))},n=document.getElementById("clearAll-Btn");return n.addEventListener("click",e),function(){n.removeEventListener("click",e)}}),[]),Object(r.useEffect)((function(){var e=setInterval((function(){var e=H(t);e!==d&&s(e)}),1500);return function(){clearInterval(e)}}),[]),Object(r.useEffect)((function(){var e;return p?e=setInterval((function(){Q(t,d,(function(){console.log("".concat(n,": ADDED ").concat(d,"MB")),s(H(t))}),(function(){O(!p)}))}),1e3):clearInterval(e),function(){clearInterval(e)}}),[p,i,d]),Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(F.Section,{children:[Object(N.jsxs)(F.InfoWrapper,{children:[n," = ",Object(N.jsxs)(F.Value,{children:[i,"MB"]})]}),Object(N.jsx)(F.Btn.Clear,{onClick:function(){J(t),s(t.length)},children:"Empty"}),Object(N.jsx)(F.Btn,{onClick:function(){return O(!p)},style:{width:"auto"},children:p?"Auto OFF":"Auto ON"}),Object(N.jsx)(F.Btn,{onClick:function(){Q(t,d,(function(){console.log("".concat(n,": ADDED ").concat(d,"MB")),s(H(t))}))},children:"Add"}),Object(N.jsx)(G,{type:"number",defaultVal:"".concat(d),postTask:function(e){return f(e)}})]})})},$=function(){return Object(N.jsx)(Y,{storageType:_,name:"Local Storage"})},X=function(){return Object(N.jsx)(Y,{storageType:K,name:"Session Storage"})},Z="demo_db",ee={users:"users",messages:"messages"},te=new BroadcastChannel("idb_changes"),ne="myid";function re(e){console.log(e)}function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=indexedDB.open(Z);t.onerror=function(e){re("IndexedDB ERR: FAILED TO CONNECT")},t.onsuccess=function(){e&&e(t.result)},t.onupgradeneeded=function(t){var n=t.currentTarget.result;for(var r in ee){n.objectStoreNames.contains(r)&&n.deleteObjectStore(r),n.createObjectStore(r).put("1234",ne)}oe(e)},t.onblocked=function(){re("IndexedDB: CONNECTION WAS BLOCKED",error)}}function ce(e){e?e.close():re("IndexedDB: DB NOT FOUND")}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=ee.messages;n||(n=f(e*l)),t||(t="".concat((new Date).toLocaleTimeString(),"_msg_").concat(e,"MB"));try{oe((function(c){var a=c.transaction([o],"readwrite"),i=a.objectStore(o).put(n,t);a.onerror=function(e){var t=e.target.error;re("IndexedDB: transaction error"),"ConstraintError"===t.name&&(alert("Key existed !"),e.preventDefault(),e.stopPropagation())},i.onerror=function(e){re("IndexedDB ERR: FAILED TO ADD DATA")},i.onsuccess=function(){re("[".concat((new Date).toLocaleTimeString(),"] IndexedDB: ADDED ").concat(e,"MB")),ce(c),r&&r()},i.onblocked=function(){re("IndexedDB: BLOCKED ADDING ".concat(e,"MB"))}}))}catch(error){re("IndexedDB ERR:")}}var ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=window.indexedDB.deleteDatabase(Z);t.onsuccess=function(){console.log("IndexedDB: ",Z,"IS DELETED"),e&&e()},t.onerror=function(){alert("IndexedDB: FAILED TO DELETE",Z)},t.onblocked=function(){alert("IndexedDB: OPERATION BEING BLOCKED")}},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee.messages,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{oe((function(r){var o=r.transaction([e],"readonly").objectStore(e).get(t);o.onerror=function(e){re("IndexedDB ERR: FAILED TO GET")},o.onsuccess=function(){ce(r),n&&n(o.result)}}))}catch(error){re("IndexedDB ERR:")}},ue=function(){var e=Object(r.useState)(!0),t=Object(a.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(1),i=Object(a.a)(c,2),s=i[0],u=i[1],l=Object(r.useState)(0),d=Object(a.a)(l,2),f=d[0],j=d[1],b=Object(r.useState)(),p=Object(a.a)(b,2),O=p[0],h=p[1],g=Object(r.useState)(!1),x=Object(a.a)(g,2),v=x[0],m=x[1],E=Object(r.useState)(""),D=Object(a.a)(E,2),S=D[0],w=D[1],B=Object(r.useState)(""),I=Object(a.a)(B,2),y=I[0],k=I[1],A=Object(r.useState)(1),C=Object(a.a)(A,2),T=C[0],R=C[1],L=Object(r.useState)(!1),M=Object(a.a)(L,2),V=M[0],z=M[1];te.onmessage=function(e){var t=e.data,n=t.action,r=t.store,o=t.key;if("UPDATE"===n)P(r,o)};var P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee.messages,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne;return se(e,t,(function(e){w(e)}))};return Object(r.useEffect)((function(){return oe((function(e){P(),ce(e),o(!1)})),function(){te.close()}}),[]),Object(r.useEffect)((function(){var e;return v?e=setInterval((function(){ae(s,null,null,(function(){return j(f+s)}))}),1e3):clearInterval(e),function(){clearInterval(e)}}),[v,f,s]),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(F.Section,{style:{height:"90px"},children:[Object(N.jsxs)(F.InfoWrapper,{children:["IndexedDB = ",Object(N.jsxs)(F.Value,{children:[f,"MB"]})]}),Object(N.jsx)(F.Btn.Clear,{disabled:n,onClick:function(){return ie((function(){return j(0)}))},children:"Reset"}),Object(N.jsx)(F.Btn,{onClick:function(){m(!v)},style:{width:"auto"},children:v?"Auto OFF":"Auto ON"}),Object(N.jsx)(G,{type:"number",placeholder:"1MB",defaultVal:"10",postTask:function(e){return u(e)}})]}),Object(N.jsxs)(F.PlainSectionOuter,{style:{height:"90px"},children:[Object(N.jsx)(F.InfoWrapper,{children:"Single Item"}),Object(N.jsx)(F.Btn.Clear,{disabled:n,onClick:function(){O?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee.messages,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{oe((function(r){var o=r.transaction([t],"readwrite").objectStore(t).delete(e);o.onerror=function(){re("IndexedDB ERR: FAILED TO DELETE")},o.onsuccess=function(){re("IndexedDB: DATA ROW DELETED"),ce(r),n&&n()}}))}catch(error){console.log("IndexedDB ERR:",error)}}(O,ee.messages):alert("Key must NOT be empty")},children:"Delete"}),Object(N.jsx)(F.Btn,{disabled:n,onClick:function(){O?ae(T,O,y,(function(){P(ee.messages,O),j(f+T),V&&te.postMessage({action:"UPDATE",store:"messages",key:O})})):alert("Key must NOT be empty")},children:"Add"}),Object(N.jsx)(G,{type:"number",defaultVal:"",placeholder:"size",postTask:function(e){return R(e)}}),Object(N.jsx)(G,{type:"text",placeholder:"Value",defaultVal:"",width:"110px",postTask:function(e){return k(e)}}),Object(N.jsx)(G,{defaultVal:"",placeholder:"Object key",width:"110px",postTask:function(e){return h(e)}})]}),Object(N.jsxs)(F.PlainSectionOuter,{children:[Object(N.jsx)("h3",{children:"Stale database due to multiple update"}),Object(N.jsx)("input",{type:"checkbox",id:"updateDummy",name:"updateDummy",checked:V,onChange:function(e){return z(!V)}}),Object(N.jsx)("label",{htmlFor:"updateDummy",children:"Trigger update on other tabs"}),Object(N.jsxs)("h3",{style:{margin:"10px 0",color:"red"},children:[ne," | ",S]})]})]})},le="demo-cache",de=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,o,c,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:null,r="/cache_".concat(Date.now().toString(),"_").concat(t,"MB"),o=new Response(f(t*l)),e.next=5,caches.open(le);case 5:return c=e.sent,e.abrupt("return",c.put(r,o).then((function(){console.log('CACHE STORAGE: SUCCESSFULLY ADDED "'.concat(r,'"')),n&&n()})).catch((function(e){alert("CACHE STORAGE: ERROR! FAILED TO WRITE CACHE")})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function fe(){return je.apply(this,arguments)}function je(){return(je=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,caches.open(le);case 2:return t=e.sent,e.next=5,t.keys();case 5:e.sent.forEach((function(e){t.delete(e)})),caches.delete(le).then((function(){console.log("CACHE STORAGE:",le,"IS DELETED")})).then((function(){window.location.reload(!0)})).catch((function(e){return console.error("CACHE STORAGE: FAILED TO DELETE",le,e)}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var be=function(){var e=Object(r.useState)(0),t=Object(a.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(0),i=Object(a.a)(c,2),s=i[0],u=i[1],l=Object(r.useState)(!1),d=Object(a.a)(l,2),f=d[0],j=d[1];return Object(r.useEffect)((function(){var e;return f?e=setInterval((function(){de(s,(function(){return o(n+s)}))}),1e3):clearInterval(e),function(){clearInterval(e)}}),[f,n,s]),Object(N.jsxs)(F.Section,{children:[Object(N.jsxs)(F.InfoWrapper,{children:["Cache Storage = ",Object(N.jsxs)(F.Value,{children:[n,"MB"]})]}),Object(N.jsx)(F.Btn.Clear,{onClick:function(){return fe()},children:"Empty"}),Object(N.jsx)(F.Btn,{onClick:function(){return j(!f)},style:{width:"120px"},children:f?"Auto OFF":"Auto ON"}),Object(N.jsx)(F.Btn,{onClick:function(){return de(s,(function(){return o(n+s)}))},children:"Add"}),Object(N.jsx)(G,{type:"number",defaultVal:"10",postTask:function(e){return u(e)}})]})},pe=function(){var e=Object(r.useState)(!0),t=Object(a.a)(e,2),n=t[0],o=t[1];return Object(N.jsxs)(F.Wrapper,{children:[Object(N.jsx)("h2",{className:"center",children:"Offline Storage Demo"}),Object(N.jsx)(P,{refetch:n,setRefetch:o}),Object(N.jsx)($,{refetch:n}),Object(N.jsx)(X,{refetch:n}),Object(N.jsx)(be,{}),Object(N.jsx)(ue,{}),Object(N.jsx)(F.SectionOuter,{children:Object(N.jsx)(F.Btn.ClearAll,{id:"clearAll-Btn",onClick:function(){J(window.localStorage),J(window.sessionStorage),fe(),ie(),o(!n)},width:"100%",children:"CLEAR ALL"})})]})},Oe=function(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsx)(pe,{})})};c.a.render(Object(N.jsx)(Oe,{}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.ac98ed88.chunk.js.map